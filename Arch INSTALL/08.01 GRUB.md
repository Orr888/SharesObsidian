# GRUB

# Алгоритм для BIOS MBR:
## Установка GRUB-BIOS, создание папки grub и создание конфига grub.cfg:
```
pacman -S grub-bios
mkdir -p /boot/grub
grub-mkconfig -o /boot/grub/grub.cfg
```
## Устанавливаем загрузчик
```
grub-install /dev/sda
```
### Выйдите из chroot размонтируйте разделы и перезагрузитесь:
```
exit
reboot
```

</br></br></br>

# Алгоритм для EFI:
## Устанавливаем ЗАГРУЗЧИК GRUB и efibootmgr:
```
pacman -S grub efibootmgr
```
### Создаем загрузочный раздел. (Если две системы, если один линукс и все, то этот пункт опускаем и переходим к генерации настроек конфигурации GRUB)
Размер раздела (boot, /dev/sda1) должен состовлять не менее 100 MB и не более 1024 MB (1 GB). У нас обычно 512 MB. И должен быть загрузочным (c флагом EFI System).   
### Форматируем под `FAT32` и создаем папку.
```
mkfs.fat32 /dev/sda1
mkdir -p /boot
```
### Монтиуем загрузочный раздел.
```
mount /dev/sda1 /mnt/boot
```
## Генерируем настройки конфигурации GRUB на разделе `/boot`.
```
grub-install --target=x86_64-efi  --bootloader-id=grub --efi-directory=/boot
```
```
grub-mkconfig -o /boot/EFI/grub/grub.cfg
```
## Выйдите из chroot размонтируйте разделы и перезагрузитесь:
```
exit
reboot
```
## В этом примере загрузочный раздел EFI с каталогом EFI/ заранее смонтирован в /boot, а ID загрузчика полностью совпадает с именем каталога "grub". Поэтому и образ, и файлы загрузчика будут установлены в один и тот же каталог EFI/grub/ на загрузочном разделе. Соответственно, в этом случае стартовый образ будет установлен в /boot/EFI/grub/grubx64.efi, конфиг загрузчика должен быть в /boot/EFI/grub/grub.cfg, а модули в каталоге /boot/EFI/grub/x86_64-efi/.